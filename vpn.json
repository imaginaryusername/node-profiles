{
 "cloudinit": null, 
 "days": 1, 
 "dcid": null, 
 "description": "OpenVPN server with FreeBSD. Returns a static key configuration.\n\nYou need to have [OpenVPN](https://openvpn.net/index.php/open-source/downloads.html) installed on your machine. Please note that currently this configuration will only work with one device at a time.\n\nOn Android, install [OpenVPN Client Free](https://play.google.com/store/apps/details?id=it.colucciweb.free.openvpn) (OpenVPN Connect and most other mobile phone clients will not work).\n\nIOS is not supported.\n\nOnce you see the configuration file on your screen, click \"Save as file\".\n\nIf using CLI:\n\nSave output and run with openvpn-client.\n\nExample: `sporestack spawn --launch vpn > vpn.ovpn; sudo openvpn-client vpn.ovpn`\n", 
 "flavor": 29, 
 "human_name": "VPN", 
 "mimetype": "application/x-openvpn-profile", 
 "name": "vpn", 
 "osid": 230, 
 "postlaunch": "cat /usr/local/etc/openvpn/client.conf\n\n\n", 
 "startupscript": "#!/bin/sh\n\nprogress() {\n\techo \"$NAME: $*\" > /dev/console\n\techo \"$NAME: $*\"\n}\n\n# This runs at the top of cloud-init. We don't even have SSHD running without\n# this.\n\nexport ASSUME_ALWAYS_YES=yes\n\nexport PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin\n\nifconfig vtnet0\n\n# pkg isn't installed by default on vultr, but this will bootstrap it\n# with the above option of ASSUME_ALWAYS_YES=yes\n\nprogress 'Starting pkg upgrade'\npkg upgrade\n\nprogress 'Starting pkg install'\npkg install openvpn pwgen\n\nprogress 'Reset root password for security reasons.'\npwgen -s 20 1 | pw user mod root -h 0 -s /bin/sh\n\nsysctl net.inet.ip.random_id=1\necho 'net.inet.ip.random_id=1' >> /etc/sysctl.conf\n\nIPV6=\"$(ifconfig vtnet0 | grep inet6 | grep -v 'inet6 fe80' | awk '{print $2}')\"\n\nmkdir /usr/local/etc/openvpn\n\ncd /usr/local/etc/openvpn\n\necho 'dev tun\ncipher AES-256-CBC\nkeepalive 10 60\nping-timer-rem\npersist-tun\npersist-key\n<secret>' > openvpn.conf\n\nopenvpn --genkey --secret static.key\ncat static.key >> openvpn.conf\n\necho '</secret>' >> openvpn.conf\n\ncp openvpn.conf client.conf\n\necho 'ifconfig 192.168.197.1 192.168.197.2' >> openvpn.conf\necho 'ifconfig 192.168.197.2 192.168.197.1' >> client.conf\n\necho 'redirect-gateway autolocal\ndhcp-option DNS 8.8.8.8' >> client.conf\n\nMYIP=$(ifconfig vtnet0 | grep 'inet ' | awk '{print $2}')\n\necho \"remote $MYIP 1194\" >> client.conf\n\n# Sendmail stuff tends to hang on the hostname not resolving.\necho 'sendmail_enable=\"NO\"\nsendmail_submit_enable=\"NO\"\nsendmail_outbound_enable=\"NO\"\nsendmail_msp_queue_enable=\"NO\"\nfirewall_type=\"open\"\nfirewall_enable=\"YES\"\ngateway_enable=\"YES\"\nopenvpn_enable=\"YES\"\nnatd_enable=\"YES\"\nnatd_interface=\"vtnet0\"\nnatd_flags=\"-dynamic -m\"' >> /etc/rc.conf\n\n# Equivalent to gateway_enable=\"YES\"\nsysctl net.inet.ip.forwarding=1\n\necho '#!/bin/sh\nifconfig vtnet0 -rxcsum -txcsum -vlanmtu -tso4 -tso6 -lro -vlanhwcsum -rxcsum6 -txcsum6 -vlanhwtso\n' > /etc/rc.local\nchmod 755 /etc/rc.local\n/etc/rc.local\n\nservice openvpn start\nservice ipfw start\n\nprogress 'All done'\n\n"
}
